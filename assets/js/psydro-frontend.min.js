jQuery(document).ready(function(e){jQuery("body").addClass("psydro-plugin");var r=e(".psydro-review-btn"),t=[],i=e("#psydro-sign-up-otp-countdown");function o(r){parent.jQuery.fancybox.close(),jQuery.fancybox.open({src:r}).current.opts.afterClose=function(){e(r+"  form").length>0&&e(r+"  form")[0].reset(),e(document).find(".psydro-remove").trigger("click")}}s(),e(window).load(function(){e(".psydro-loader-box").remove()}),e('[data-fancybox="psydro"]').fancybox({zoomSpeedIn:300,zoomSpeedOut:300,overlayShow:!1,enableEscapeButton:!0,showCloseButton:!0}),e("#psydro_phone").keypress(function(e){var r=(e=e||window.event).which?e.which:e.keyCode;return!(r>31&&(r<48||r>57))}),e("#psydro_otp").keydown(function(e){var r=(e=e||window.event).which?e.which:e.keyCode;return!(r>31&&(r<48||r>57))}),e(document).on("click",".psydro-read-more-point",function(){var r=e(this).data("review-id"),t="";t+='<div><span class="psydro-review-view-more-username">'+e("#"+r).find(".psydro-review-username").text()+'</span> <span class="psydro-review-view-more-datetime">'+e("#"+r).find(".psydro-rating-time").text()+"</div>",t+=e("#"+r).find(".psydro-vertical-slider-stars").html(),t+='<div class="psydro-review-view-more-title">'+e("#"+r).find(".psydro-rating-header-text").html()+"</div>",t+='<div class="psydro-review-view-more-review">'+e("#"+r).find(".psydro-review-full").html()+"</div>",e("#psydro-review-read-more-content").html(t),o("#psydro-review-read-more-popup")}),e(".psydro-review-btn").click(function(){r.text(n()?"Enter OTP":"Write A Review"),c("sign_up_datetime")?o("#psydro-sign-up-otp-popup"):c("user_token")?o("#psydro-write-review-popup"):o("#psydro-sign-in-popup")}),e(document).on("click",".psydro-fancybox",function(){o(e(this).attr("href"))}),e(document).on("click",".psydro-fancybox-close",function(){jQuery.fancybox.close()}),e(document).on("click",".psydro-resend-otp",function(){var r=e("#psydro-otp");return p(r),a({url:"otpresend",method:"post",data:{}}).then(function(e){u(e.data,r),!1===e.data.error&&(y("sign_up_datetime",new Date),s()),l(r)},e=>{l(r)}),!1});e(".psydro-inverified-multiple-upload").psydroReviewImageUpload({thumbWrapWithIn:".psydro-inverified-multiple-upload-thumbs",multipleFiles:!0,limit:3,uploadOnSelect:!0,ajaxUrl:"https://psydro.com/api/upload-temp-image",disabledBtnClass:"#hb-submit-writeRev"},function(e){});function n(){return c("sign_up_datetime")}function s(){r.text(n()?"Enter OTP":"Write A Review");var e=c("sign_up_datetime");e=moment(e).add(30,"seconds");var t=setInterval(function(){seconds=moment().diff(e,"seconds"),seconds>0||isNaN(seconds)?(clearTimeout(t),i.html('<div id="psydro-resend-text"><a class="psydro-resend-otp" href="javascript:void(0)">Resend OTP </a></div>')):i.html('<div> Resend OTP in <span id="time">'+Math.abs(seconds)+"</span> seconds!</div>")},1e3)}function d(r,t){return e(t).find('input[name="'+r+'"]').val()}function a(e){return e.headers={ApiKey:"fqi0PE~ao8RA&Ijk2u71FcJl}kQF/1"},e.url=psydro_env.base_url+e.url,e.data instanceof FormData?e.data.append("api_token",c("sign_up_token")?c("sign_up_token"):c("user_token")):e.data.api_token=c("sign_up_token")?c("sign_up_token"):c("user_token"),axios(e)}function u(r,t){var i=e(t).find(".psydro-message-container"),o=!0===r.error?"error":"success";e(i).html(""),e(i).html('<div class="psydro-message psydro-'+o+'">'+r.message+"</div>"),clearTimeout(n);var n=setTimeout(function(){e(i).html("")},6e5)}function p(r){e(r).find('input[type="submit"]').attr("disabled",!0)}function l(r){e(r).find('input[type="submit"]').attr("disabled",!1)}function m(r,t){if(r){if(r.size>5242880)return void alert("You selected image is more than 5 MB");var i=new FileReader;i.onload=function(r){e("#psydro_image_upload_box").append('<div class="psydro_review_thumbnail" id="psydro_review_thumbnail_'+t+'"  > <img  src="'+r.target.result+'"/> <span class="remove_psydro_thumbnail"  data-id='+t+"> x </span> </div>")},i.readAsDataURL(r)}}function c(e){for(var r="psydro_"+e+"=",t=decodeURIComponent(document.cookie).split(";"),i=0;i<t.length;i++){for(var o=t[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(r))return o.substring(r.length,o.length)}return""}function y(e,r){var t=new Date;t.setTime(t.getTime()+6e5);var i="; expires="+t.toGMTString();document.cookie="psydro_"+e+" ="+r+i+"; path=/"}function F(e){document.cookie="psydro_"+e+"=; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}e("#psydro-signin").validate({rules:{psydro_email:{required:!0,email:!0},psydro_password:{required:!0}},messages:{psydro_email:{required:"Email is required.",email:"Email is not valid."},psydro_password:{required:"Password is required."}},submitHandler:function(r){return p(r),a({url:"logInByExtension",method:"post",data:{email:d("psydro_email",r),password:d("psydro_password",r),from:"1",user_type:"1",device_type:"2"}}).then(function(t){l(r),u(t.data,r),!1===t.data.error&&(e(r)[0].reset(),y("user_token",t.data.api_token),setTimeout(function(){o("#psydro-write-review-popup"),e(".psydro-message-container").empty()},2e3))},e=>{l(r)}),!1}}),e("#psydro-signup").validate({rules:{psydro_username:{required:!0},psydro_phone:{required:!0},psydro_signupemail:{required:!0,emailfull:!0},psydro_countryCode:{required:!0},psydro_terms_condition:{required:!0}},messages:{psydro_username:{required:"Username is required."},psydro_phone:{required:"Phone No. is required.",minlength:"Please enter at least 9 numbers."},psydro_signupemail:{required:"Email is required."},psydro_countryCode:{required:"Country code is required."},psydro_terms_condition:{required:"Accept terms and condition"}},showErrors:function(r,t){t.length>0?e("#psydromyErrorContainer").html("<p>"+t[0].message+"</p>"):e("#psydromyErrorContainer").html("")},submitHandler:function(r){return p(r),a({url:"signupByExtension",method:"post",data:{username:d("psydro_username",r),phone:d("psydro_countryCode",r)+d("psydro_phone",r),email:d("psydro_signupemail",r)}}).then(function(t){l(r),u(t.data,r),!1===t.data.error&&(e(r)[0].reset(),y("sign_up_token",t.data.api_token),setTimeout(function(){y("sign_up_datetime",new Date),o("#psydro-sign-up-otp-popup"),s(),e(".psydro-message-container").empty()},2e3))},e=>{l(r)}),!1}}),e("#psydro-sign-up-otp-validate").validate({rules:{psydro_otp:{required:!0}},messages:{psydro_otp:{required:"OTP is required."}},submitHandler:function(r){return p(r),a({url:"otpVerification",method:"post",data:{otp:d("psydro_otp",r)}}).then(function(t){l(r),u(t.data,r),!1===t.data.error&&(e(r)[0].reset(),F("sign_up_datetime"),y("user_token",c("sign_up_token")),F("sign_up_token"),setTimeout(function(){s(),o("#psydro-write-review-popup"),e(".psydro-message-container").empty()},2e3))},e=>{l(r)}),!1}}),e("#psydro-forgot").validate({rules:{psydro_forgotemail:{required:!0,email:!0}},messages:{psydro_forgotemail:{required:"Email is required.",email:"Email is not valid."}},submitHandler:function(e){return p(e),a({url:"ExtensionForgetPass",method:"post",data:{email:d("psydro_forgotemail",e)}}).then(function(r){l(e),u(r.data,e)},r=>{l(e)}),!1}}),e(".psydro-star").click(function(){for(var r=e(this).attr("id"),t=5;t>r;t--)e("#"+t).removeClass("starchecked");for(t=1;t<=r;t++)e("#"+t).addClass("starchecked");e(".psydro-rvw-star").attr("data-rating",r)}),e("#psydro-write-review-form").validate({rules:{psydro_review_title:{required:!0},psydro_review_description:{required:!0}},messages:{psydro_review_title:{required:"Title is required."},psydro_review_description:{required:"Description is required."}},submitHandler:function(r){var t=e(".psydro-rvw-star").data("rating"),i=null==t?5:t;p(r);var n=new FormData,s=e("input[name='psydro-unverified-images[]']").map(function(){return e(this).val()}).get();return n.append("site_token",psydro_env.api_key),n.append("title",d("psydro_review_title",r)),n.append("description",jQuery("textarea[name=psydro_review_description]").val()),n.append("rating",i),n.append("unverified_images",s),a({url:"writeReviewByExtention",method:"post",data:n}).then(function(t){l(r),u(t.data,r),!1===t.data.error&&(e(r)[0].reset(),o("#psydro-success-feedback-popup"),F("user_token"))},e=>{l(r)}),!1}}),jQuery.validator.addMethod("emailfull",function(e,r){return this.optional(r)||/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(e)},"Please enter valid email address!"),jQuery("#psydro-images").change(function(e){for(var r=e.target.files,i=0;i<r.length;i++){if(!(r.length<=3)){alert("You can upload maximum of 3 images end");break}if(!(t.length<3)){alert("You can upload maximum of 3 images");break}t.push(r[i]),m(r[i],i)}}),e(document).on("click",".remove_psydro_thumbnail",function(){var r=e(this).data("id");e("#psydro_review_thumbnail_"+r).remove(),t.pop(r)})}(jQuery));